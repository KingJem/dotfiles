
" Install vim-plug if not found
if empty(glob('~/.vim/autoload/plug.vim'))
  silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
    \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
endif

" Run PlugInstall if there are missing plugins
autocmd VimEnter * if len(filter(values(g:plugs), '!isdirectory(v:val.dir)'))
  \| PlugInstall --sync | source $MYVIMRC
\| endif

call plug#begin()
Plug 'puremourning/vimspector'
Plug 'vim-airline/vim-airline'
Plug 'airblade/vim-gitgutter'
Plug 'tpope/vim-fugitive'
Plug 'preservim/nerdtree'
Plug 'lervag/vimtex'
Plug 'godlygeek/tabular'
Plug 'plasticboy/vim-markdown'
Plug 'ferrine/md-img-paste.vim'
Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }
Plug 'junegunn/fzf.vim'
call plug#end()


let g:vimspector_enable_mappings = 'HUMAN'
let mapleader = "\<space>" 

"function! s:read_template_into_buffer(template)
"" has to be a function to avoid the extra space fzf#run insers otherwise
"execute â€˜0r ~/.vim/vimspector_json/â€™.a:template
"endfunction
"command! -bang -nargs=* LoadVimSpectorJsonTemplate call fzf#run({
"\ â€˜sourceâ€™: â€˜ls -1 ~/.vim/vimspector_jsonâ€™,
"\ â€˜downâ€™: 20,
"\ â€˜sinkâ€™: function(â€˜read_template_into_bufferâ€™)
"\ })
"" %:p:hè¿”å›å½“å‰è°ƒè¯•æºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•
"" å¦‚æœæ²¡æœ‰%:p:hæ—¶.vimspector.jsonä¼šè¢«é»˜è®¤å­˜åˆ°vim/nvimå¯åŠ¨ç›®å½•
"" ~$nvim test/main.cpp æ²¡æœ‰%:p:hæ—¶åˆ™è¿”å›~/.vimspector.json å¦‚æœæœ‰ %:p:h/.vimspector.jsonè¿”å›~/test/.vimspector.json
"noremap vs :tabe %:p:h/.vimspector.json:LoadVimSpectorJsonTemplate
"sign define vimspectorBP text=ğŸ›‘ texthl=Normal
"sign define vimspectorBPDisabled text=ğŸš« texthl=Normal
"sign define vimspectorPC text=ğŸ‘‰ texthl=SpellBad



set nu                      " æ˜¾ç¤ºè¡Œå·
set tabstop=4               " è®¾ç½®è½¯åˆ¶è¡¨ç¬¦å®½åº¦ä¸º4
set softtabstop=4           " è®¾ç½®è½¯åˆ¶è¡¨ç¬¦å®½åº¦ä¸º4
set shiftwidth=4            " è®¾ç½®ç¼©è¿›çš„ç©ºæ ¼æ•°ä¸º4
set autoindent              " è®¾ç½®è‡ªåŠ¨ç¼©è¿›ï¼šå³æ¯è¡Œçš„ç¼©è¿›å€¼ä¸ä¸Šä¸€è¡Œç›¸ç­‰
set cursorline              " çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ
set expandtab               " ç©ºæ ¼ä»£æ›¿åˆ¶è¡¨ç¬¦
set showmatch               " å…‰æ ‡é‡åˆ°åœ†æ‹¬å·ã€æ–¹æ‹¬å·ã€å¤§æ‹¬å·æ—¶ï¼Œè‡ªåŠ¨é«˜äº®å¯¹åº”çš„å¦ä¸€ä¸ªåœ†æ‹¬å·ã€æ–¹æ‹¬å·å’Œå¤§æ‹¬å·
set ruler                   " åœ¨çŠ¶æ€æ æ˜¾ç¤ºå…‰æ ‡çš„å½“å‰ä½ç½®ï¼ˆä½äºå“ªä¸€è¡Œå“ªä¸€åˆ—ï¼‰
set guifont=Consolas:h15    " è®¾ç½®å­—ä½“å’Œå­—ä½“å¤§å°
set nobackup                " å–æ¶ˆå¤‡ä»½æ–‡ä»¶
                            " é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶ä¿å­˜æ—¶ï¼Œä¼šé¢å¤–åˆ›å»ºä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œå®ƒçš„æ–‡ä»¶åæ˜¯åœ¨åŸæ–‡ä»¶åçš„æœ«å°¾ï¼Œå†æ·»åŠ ä¸€ä¸ªæ³¢æµªå·~
setlocal noswapfile         " ä¸åˆ›å»ºäº¤æ¢æ–‡ä»¶ã€‚äº¤æ¢æ–‡ä»¶ä¸»è¦ç”¨äºç³»ç»Ÿå´©æºƒæ—¶æ¢å¤æ–‡ä»¶ï¼Œæ–‡ä»¶åçš„å¼€å¤´æ˜¯.ã€ç»“å°¾æ˜¯.swp
set noundofile              " å–æ¶ˆç”Ÿæˆunæ–‡ä»¶
set hlsearch                " è®¾ç½®é«˜äº®æ˜¾ç¤ºæœç´¢å­—ç¬¦ä¸²
set showmode                " åœ¨åº•éƒ¨æ˜¾ç¤ºï¼Œå½“å‰å¤„äºå‘½ä»¤æ¨¡å¼è¿˜æ˜¯æ’å…¥æ¨¡å¼
set showcmd                 " å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œåœ¨åº•éƒ¨æ˜¾ç¤ºï¼Œå½“å‰é”®å…¥çš„æŒ‡ä»¤ã€‚æ¯”å¦‚è¾“å…¥å¿«æ·é”®å°†åœ¨åº•éƒ¨æ˜¾ç¤ºå…·ä½“å‘½ä»¤
set t_Co=256                " å¯ç”¨256è‰²
set noerrorbells            " å‡ºé”™æ—¶ä¸è¦å‘å‡ºå“å£°
" é«˜äº®æ˜¾ç¤º
syntax on
syntax enable


Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all'  }
Plug 'junegunn/fzf.vim'
let g:vimspector_base_dir=expand('~/.vim/.vimspectorjson')
function! s:read_template_into_buffer(template)
    " has to be a function to avoid the extra space fzf#run insers otherwise
    execute '0r ~/.vim/.vimspectorjson/'.a:template
endfunction
command! -bang -nargs=* LoadVimSpectorJsonTemplate call fzf#run({
            \   'source': 'ls -1 ~/.vim/.vimspectorjson',
            \   'down': 20,
            \   'sink': function('<sid>read_template_into_buffer')
            \ })
noremap <leader>db :tabe .vimspector.json<CR>:LoadVimSpectorJsonTemplate<CR>
sign define vimspectorBP text=â˜› texthl=Normal
sign define vimspectorBPDisabled text=â˜ texthl=Normal
sign define vimspectorPC text=Â¶ texthl=SpellBad

"let g:vimspector_configuration = {
"            \  "configurations": {
"            \    "run current script": {
"            \      "adapter": "debugpy",
"            \      "variables": {
"            \        "python": {
"            \          "shell": "/bin/bash -c 'test -n \"$${VIRTUAL_ENV}\" && echo $${VIRTUAL_ENV}/bin/python || echo python3'"
"            \        }
"            \      },
"            \      "configuration": {
"            \        "request": "launch",
"            \        "type": "python",
"            \        "cwd": "${CWD:${workspaceRoot\\}}",
"            \        "program": "${file}",
"            \        "console": "integratedTerminal",
"            \        "args": [ "*${args}" ],
"            \        "python": "${python}"
"            \      },
"            \      "breakpoints": {
"            \        "exception": {
"            \          "raised": "N",
"            \          "uncaught": ""
"            \        }
"            \      }
"            \    },
"            \    "attach": {
"            \      "adapter": "multi-session",
"            \      "configuration": {
"            \        "request": "attach"
"            \      },
"            \      "breakpoints": {
"            \        "exception": {
"            \          "raised": "N",
"            \          "uncaught": ""
"            \        }
"            \      }
"            \    }
"            \  }
"            \}
"



"Plug 'sagi-z/vimspectorpy', { 'do': { -> vimspectorpy#update() } }
"o


"let g:vimspector_configuration = {
"            \{
"            \  "adapters": {
"            \    "debugpy": {
"            \      "command": [
"            \        "python",
"            \        "-m",
"            \        "debugpy.adapter"
"            \      ],
"            \      "name": "debugpy",
"            \      "configuration": {
"            \        "python": "python"
"            \      }
"            \    }
"            \  },
"            \  "configurations": {
"            \    "run - debugpy": {
"            \      "adapter": "debugpy",
"            \      "configuration": {
"            \        "request": "launch",
"            \        "type": "python",
"            \        "cwd": "${workspaceRoot}",
"            \        "program": "${file}",
"            \        "console": "integratedTerminal"
"            \      },
"            \      "breakpoints": {
"            \        "exception": {
"            \          "raised": "N",
"            \          "uncaught": ""
"            \        }
"            \      }
"            \    }
"            \  }
"            \}
"            \}

